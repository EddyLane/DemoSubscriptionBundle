language: php

php:
  - 5.5

before_script:

  - sudo apt-get install nginx
  - sudo apt-get install php5-fpm

  - sudo cp $TRAVIS_BUILD_DIR/vhost.template /etc/nginx/sites-enabled/fridge-subscription-demo.local
  - sed 's|APP_URLS|fridge-subscription-demo.local|g;s|APP_PATH|/home/travis/build/EddyLane/DemoSubscriptionBundle|g;s|APP_NAME|fridge-subscription-demo.local|g' /etc/nginx/sites-enabled/fridge-subscription-demo.local

  - composer update
  - app/console doc:database:create
  - app/console doc:schema:update --force

  - sudo service nginx restart
  - sudo service php5-fpm restart

  - cat /etc/nginx/sites-enabled/fridge-subscription-demo.local

script:
  - ./bin/behat --config behat.yml

addons:
  hosts:
    - fridge-subscription-demo.local